# E2E Cipher (Telegram plugin) (P.S. README сгенерирован ИИ, но проверен на правильность)

## Клиент телеграм - https://github.com/exteraSquad/exteraGram

## Что это
E2E Cipher — пользовательский слой шифрования для чатов Telegram. Плагин автоматически
шифрует исходящие сообщения в выбранных чатах и позволяет расшифровывать их по ключам,
которые задаются отдельно для каждого чата.

## Зачем
- снизить риск утечки текста при пересылках/логах/снимках экрана;
- отделить доступ к содержимому от доступа к истории чата;
- продемонстрировать современную криптографию для ИБ‑проекта (VSOS/Hack).

## Основные возможности
- Авто‑шифрование сообщений при `e2e on` или через кнопку‑замок в панели чата.
- Расшифровка отдельного сообщения: команда `.e2e dec` (reply) или контекстное меню.
- Расшифровка всех сообщений чата через меню действий чата.
- Epstein‑mode: теги и @упоминания остаются видимыми при шифровании.
- Ссылки шифруются и отправляются как обычные сообщения.
- Self‑test криптографии.

## Криптография
- Алгоритм: AES‑GCM (AEAD), `AES/GCM/NoPadding`.
- IV: 12 байт, Tag: 128 бит.
- Ключи: PBKDF2‑HMAC‑SHA256, 100000 итераций, соль 16 байт, ключ 256 бит.
- Базовый формат: `e2e1:<base64(iv + ciphertext + tag)> [#tags @mentions]`.
- Дешифровка всегда проходит по всем ключам (минимизация timing‑leak).

Важно: сохраненные ранее ключи и старые сообщения (CBC) не поддерживаются.
Нужно задать ключи заново.

## Установка
1. Скопируй файл `Plugins/e2e_chat.plugin` в плагины Telegram‑клиента.
2. Перезапусти клиент.
3. В чате задай ключи: `.e2e keys <5 ключей>`.

## Быстрый старт
1. `.e2e keys <5 ключей>`
2. `.e2e on` или нажми кнопку‑замок в панели чата.
3. Отправляй сообщения — они уходят сразу зашифрованными.

## Команды
- `.e2e keys <5 ключей>` — задать 5 ключей для текущего чата.
- `.e2e on` / `.e2e off` — включить/выключить шифрование.
- `.e2e status` — статус и количество ключей.
- `.e2e dec` — расшифровать сообщение (ответь на него).
- `.e2e clear` — удалить ключи и выключить шифрование.
- `.e2e selftest` — проверка AES‑GCM + PBKDF2.

## Настройки
В настройках плагина:
- **Режим Эпштейна** — теги и @упоминания остаются видимыми.
В чате:
- Кнопка‑замок в панели ввода включает/выключает шифрование для текущего чата.

## Модель угроз (кратко)
Защищает:
- от чтения содержимого без ключей;
- от подмены шифртекста (GCM подтверждает целостность).

Не защищает:
- от компрометации устройства/клавиатуры;
- от утечки ключей;
- от социальной инженерии.

## Ограничения
- Только текстовые сообщения (включая ссылки).
- Ключи нужно хранить и передавать безопасно.
- Вложения/медиа не шифруются.

